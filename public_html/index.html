<!doctype html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Coalition Server</title>
    <link href="css/coalition.css" rel="stylesheet" type="text/css"></link>
    <script src="js/jquery.min.js"></script>
    <script src="js/coalition.js"></script>
    <script src="js/table-config.js"></script>
	</head>

	<body class="flex-row flex-nowrap">
		<div id="content" class="flex-column">
			<div id="header" class="flex-column">
        <div class="flex-row flex-grow">
          <div class="flex-column flex-grow">
						<div class="flex-row">
							<div id="maintitle">
								<a href="https://github.com/MercenariesEngineering/coalition/" target="_blank">Coalition</a>
							</div>
							<div id="subtitle">
								<p>A small but beautiful job manager by <a href="http://www.mercenaries-engineering.com" target="_blank">Mercenaries Engineering</a> - LGPL licence - <a href="https://coalition.readthedocs.io" target="_blank">Documentation</a></p>
							</div>
						</div>
          </div>

          <div class="flex-column">
            <div class="flex-row">
              <button id="copy-url-button" class="button" type="submit" value="copy-url" onclick="configTableCopyUrl()">Copy this view url to clipboard</button>
              <textarea id="copy-url-textarea" class="not-displayed"></textarea>
              <button type="button" id="refreshbutton" class="button" onclick="refresh()">Refresh</button>
              <label id="auto-refresh-button">auto<input id="autorefresh" class="auto" type="checkbox"></label>
              <div id="logout-button"></div>
              <div id="menu-button" class="menu-button" onclick="configTableMenuToggle();">&equiv;</div>
            </div>
          </div>
        </div>

        <div class="flex-row flex-grow">
          <div id="tabs" class="flex-column">
            <div class="flex-row">
              <button type="button" id="jobtab" class="button activetab" onclick="showPage('jobs')">Jobs</button>
              <button type="button" id="workertab" class="button" onclick="showPage('workers')">Workers</button>
              <button type="button" id="activitytab" class="button" onclick="showPage('activities')">Activities</button>
              <button type="button" id="logtab" class="button" onclick="showPage('logs')">Log</button>
              <button type="button" id="affinitytab" class="button" onclick="showPage('affinities')">Affinities</button>
            </div>
          </div>
        </div>
			</div>

      <div id="main" class="flex-row flex-grow">
        <div id="jobsTab" class="tab-content flex-column flex-nowrap">
          <div id="jobtools" class="flex-row">
            <button type="reset" class="button" onclick="configTableReset();">Reset table setup</button>
            <div class="flex-column">
              <div class="button" id="b01">
                <label>Selection</label>
                <select id="selectJobs" onchange="selectJobs()" value="CUSTOM">
                  <option value="NONE">NONE</option>
                  <option value="ALL">ALL</option>
                  <option value="WORKING">WORKING</option>
                  <option value="ERROR">ERROR</option>
                  <option value="WAITING">WAITING</option>
                  <option value="FINISHED">FINISHED</option>
                  <option value="PAUSED">PAUSED</option>
                  <option value="CUSTOM">CUSTOM</option>
                </select>
              </div>
            </div>
            <button type="button" class="button" id="b03" onclick="resetSelection()">Reset<img src="img/icon_refresh.png"></button>
            <button type="button" class="button" id="b04" onclick="resetErrorSelection()">Reset errors<img src="img/icon_refresh.png"></button>
            <button type="button" class="button" id="b05" onclick="startSelection()">Start<img src="img/icon_play.png"></button>
            <button type="button" class="button" id="b06" onclick="pauseSelection()">Pause<img src="img/icon_pause.png"></button>
            <button type="button" class="button" id="b07" onclick="cutSelection()">Cut<img src="img/icon_cut.png"></button>
            <button type="button" class="button" id="b11" onclick="pasteSelection()">Paste<img src="img/icon_paste.png"></button>
            <button type="button" class="button" id="b03" onclick="removeSelection()">Delete<img src="img/icon_remove.png"></button>
            <button type="button" class="button" id="b08" onclick="logSelection()">Log<img src="img/icon_logs.png"></button>
            <button type="button" class="button" id="b09" onclick="jobActivity()">Activity<img src="img/icon_activity.png"></button>
            <button type="button" class="button" id="b10" onclick="exportCSV()">CSV<img src="img/icon_tabler.png"></button>
            <form id="sql-search-job" class="sql-search-form" onsubmit="onSqlSearchFormSubmit(event)">
              <input id="submit-sql-search-jobsTable" type="submit" class="not-displayed">
            </form>
          </div>
          <div id="parents" class="flex-row"></div>
          <div id="jobs" class="flex-row"><table id="jobsTable"></table></div>
          <details id="jobtoolstable" class="flex-row">
            <div class="flex-row">
              <button type="button" class="button" name="updatejobsButton" onclick="updatejobs()">Update</button>
              <button type="button" class="button" name="addjobButton" onclick="addjob()">Add job</button>
            </div>
            <div class="flex-row">
              <div class="flex-column width-50pc">
                <label class="flex-row"><span>Title:</span><input type="edit" class="ttedit" id="title" name="title" value="Job" onchange="onchangejobprop('title')"></label>
                <label class="flex-row"><span>Priority:</span><input type="edit" class="ttedit" id="priority" name="priority" value="127" onchange="onchangejobprop('priority')"></label>
                <label class="flex-row"><span>Command:</span><input type="edit" class="ttedit" id="cmd" name="cmd" value="" onchange="onchangejobprop('cmd')"></label>
                <label class="flex-row"><span>Timeout:</span><input type="edit" class="ttedit" id="timeout" name="timeout" value="0" onchange="onchangejobprop('timeout')"></label>
                <label class="flex-row"><span>Directory:</span><input type="edit" class="ttedit" id="dir" name="dir" value="." onchange="onchangejobprop('dir')"></label>
              </div>
              <div class="flex-column width-50pc">
                <label class="flex-row"><span>Affinity:</span><input type="edit" class="ttedit" id="affinity" name="affinity" value="" onchange="onchangejobprop('affinity')"></label>
                <label class="flex-row"><span>Dependencies:</span><input type="edit" class="ttedit" id="dependencies" name="dependencies" value="" onchange="onchangejobprop('dependencies')"></label>
                <label class="flex-row"><span>User:</span><input type="edit" class="ttedit" id="user" name="user" value="" onchange="onchangejobprop('user')"></label>
                <label class="flex-row"><span>URL:</span><input type="edit" class="ttedit" id="url" name="url" value="" onchange="onchangejobprop('url')"></label>
                <label class="flex-row"><span>Environment:</span><input type="edit" class="ttedit" id="env" name="env" value="" onchange="onchangejobprop('env')"></label>
              </div>
            </div>
          </details>
        </div>

				<div id="workersTab" class="tab-content flex-column">
					<div id="workertools" class="flex-row">
            <button type="reset" class="button" onclick="configTableReset();">Reset table setup</button>
						<button class="button" id="b06" onclick="selectAll(true)"><img src="img/icon_select.png">Select all</button>
						<button class="button" id="b07" onclick="selectAll(false)"><img src="img/icon_none.png">Select none</button>
						<button class="button" id="b09" onclick="startWorkers()"><img src="img/icon_play.png">Start</button>
						<button class="button" id="b10" onclick="stopWorkers()"><img src="img/icon_pause.png">Stop</button>
						<button class="button" id="b08" onclick="clearWorkers()"><img src="img/icon_remove.png">Delete</button>
						<button class="button" id="b11" onclick="workerActivity()"><img src="img/icon_activity.png">Activity</button>
						<button class="button" id="b13" onclick="terminateWorkers()"><img src="img/icon_terminate.png">Terminate</button>
            <form id="sql-search-worker" class="sql-search-form" onsubmit="onSqlSearchFormSubmit(event)">
              <input id="submit-sql-search-workersTable" type="submit" class="not-displayed">
            </form>
					</div>

					<div id="workers">
            <table id='workersTable'></table>
					</div>

					<details id="workertoolstable" class="flex-row">
						<div class="flex-column">
							<form>
								<label class="flex-row">
									<span class="flex-column">Affinity:</span>
									<textarea type="edit" class="ttedit flex-column" id="waffinity" name="waffinity" title="Comma separated affinities names as defined in the affinities tab" value="" onchange="onchangeworkerprop('waffinity')"></textarea>
								</label>
							</form>
						</div>
						<div class="flex-column">
							<button type="button" class="button" name="updatejobsButton" value="Update" onclick="updateworkers()">Update</button>
						</div>
					</details>
				</div>

				<div id="logsTab" class="tab-content flex-column">
					<div id="logtools" class="flex-row">
						<button class="button" id="b12" onclick="clearLog()"><img src="img/icon_remove.png">Clear</button>
					</div>
					<div id="logs" class="flex-row">
					</div>
				</div>

				<div id="activitiesTab" class="tab-content flex-column">
					<div id="activitiestools" class="flex-row">
						<div class="flex-column">
							<label id="Div2" class="flex-row">
								<span class="flex-column">Job&nbsp;filter:</span>
								<input id="activityJob" class="flex-column" onchange="reloadActivities()">
							</label>
						</div>
						<div class="flex-column">
							<label id="Div3" class="flex-row">
								<span class="flex-column">Worker&nbsp;filter:</span>
								<input id="activityWorker" class="flex-column" onchange="reloadActivities()">
							</label>
						</div>
						<div class="flex-column">
							<label id="Div4" class="flex-row">
								<span class="flex-column">Since:</span>
								<select id="howlong" class="flex-column" onchange="reloadActivities()">
									<option value="60">Last minute</option>
									<option value="600">Last 10 minutes</option>
									<option value="3600">Last hour</option>
									<option value="28800">Last 8 hours</option>
									<option value="86400">Last day</option>
									<option value="604800">Last week</option>
									<option value="2592000">Last month</option>
									<option value="15552000">Last 6 monthes</option>
									<option value="100000000000">All</option>
								</select>
							</label>
						</div>
					</div>
					<div id="activities">
            <table id='activitiesTable'></table>
					</div>
				</div>

				<div id="affinitiesTab" class="tab-content flex-column">
					<div id="affinities" class="flex-row">
            <table id='affinitiesTable'></table>
					</div>
					<div id="affinitytoolstable" class="flex-row">
						<button type="button" class="button" name="updateaffinitiesButton" onclick="sendAffinities()">Update</button>
					</div>
				</div>
			</div>

			<div id="footer" class="flex-row">
			</div>
		</div>
	</body>
</html>

